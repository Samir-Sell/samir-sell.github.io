const I=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["«","»"],["»","«"],["‹","›"],["›","‹"],["⁽","⁾"],["⁾","⁽"],["₍","₎"],["₎","₍"],["≤","≥"],["≥","≤"],["〈","〉"],["〉","〈"],["﹙","﹚"],["﹚","﹙"],["﹛","﹜"],["﹜","﹛"],["﹝","﹞"],["﹞","﹝"],["﹤","﹥"],["﹥","﹤"]],E=["آ","أ","إ","ا"],$=["ﻵ","ﻷ","ﻹ","ﻻ"],tt=["ﻶ","ﻸ","ﻺ","ﻼ"],j=["ا","ب","ت","ث","ج","ح","خ","د","ذ","ر","ز","س","ش","ص","ض","ط","ظ","ع","غ","ف","ق","ك","ل","م","ن","ه","و","ي","إ","أ","آ","ة","ى","ل","م","ن","ه","و","ي","إ","أ","آ","ة","ى","ی","ئ","ؤ"],rt=["ﺍ","ﺏ","ﺕ","ﺙ","ﺝ","ﺡ","ﺥ","ﺩ","ﺫ","ﺭ","ﺯ","ﺱ","ﺵ","ﺹ","ﺽ","ﻁ","ﻅ","ﻉ","ﻍ","ﻑ","ﻕ","ﻙ","ﻝ","ﻡ","ﻥ","ﻩ","ﻭ","ﻱ","ﺇ","ﺃ","ﺁ","ﺓ","ﻯ","ﯼ","ﺉ","ﺅ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺉ","ﺅ"],et=["ﺎ","ﺐ","ﺖ","ﺚ","ﺞ","ﺢ","ﺦ","ﺪ","ﺬ","ﺮ","ﺰ","ﺲ","ﺶ","ﺺ","ﺾ","ﻂ","ﻆ","ﻊ","ﻎ","ﻒ","ﻖ","ﻚ","ﻞ","ﻢ","ﻦ","ﻪ","ﻮ","ﻲ","ﺈ","ﺄ","ﺂ","ﺔ","ﻰ","ﯽ","ﺊ","ﺆ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺊ","ﺆ"],nt=["ﺎ","ﺒ","ﺘ","ﺜ","ﺠ","ﺤ","ﺨ","ﺪ","ﺬ","ﺮ","ﺰ","ﺴ","ﺸ","ﺼ","ﻀ","ﻄ","ﻈ","ﻌ","ﻐ","ﻔ","ﻘ","ﻜ","ﻠ","ﻤ","ﻨ","ﻬ","ﻮ","ﻴ","ﺈ","ﺄ","ﺂ","ﺔ","ﻰ","ﯿ","ﺌ","ﺆ","ﹱ","ﹲ","ﹴ","ﹷ","ﹹ","ﹻ","ﹽ","ﹿ","ﺀ","ﺌ","ﺆ"],ot=["ﺍ","ﺑ","ﺗ","ﺛ","ﺟ","ﺣ","ﺧ","ﺩ","ﺫ","ﺭ","ﺯ","ﺳ","ﺷ","ﺻ","ﺿ","ﻃ","ﻇ","ﻋ","ﻏ","ﻓ","ﻗ","ﻛ","ﻟ","ﻣ","ﻧ","ﻫ","ﻭ","ﻳ","ﺇ","ﺃ","ﺁ","ﺓ","ﻯ","ﯾ","ﺋ","ﺅ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺋ","ﺅ"],z=["ء","آ","أ","ؤ","إ","ا","ة","د","ذ","ر","ز","و","ى"],at=["ً","ً","ٌ","؟","ٍ","؟","َ","َ","ُ","ُ","ِ","ِ","ّ","ّ","ْ","ْ","ء","آ","آ","أ","أ","ؤ","ؤ","إ","إ","ئ","ئ","ئ","ئ","ا","ا","ب","ب","ب","ب","ة","ة","ت","ت","ت","ت","ث","ث","ث","ث","ج","ج","ج","ج","ح","ح","ح","ح","خ","خ","خ","خ","د","د","ذ","ذ","ر","ر","ز","ز","س","س","س","س","ش","ش","ش","ش","ص","ص","ص","ص","ض","ض","ض","ض","ط","ط","ط","ط","ظ","ظ","ظ","ظ","ع","ع","ع","ع","غ","غ","غ","غ","ف","ف","ف","ف","ق","ق","ق","ق","ك","ك","ك","ك","ل","ل","ل","ل","م","م","م","م","ن","ن","ن","ن","ه","ه","ه","ه","و","و","ى","ى","ي","ي","ي","ي","ﻵ","ﻶ","ﻷ","ﻸ","ﻹ","ﻺ","ﻻ","ﻼ","؟","؟","؟"],q=["ء","ف"],it=["غ","ي"],st=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],ut=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],e=0,i=1,h=2,g=3,t=4,S=5,W=6,r=7,m=8,R=9,_=10,T=11,n=12,ft=13,lt=14,ct=15,ht=16,Tt=17,c=18,At=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],p=100,Lt=[p+0,e,e,e,e,p+1,p+2,p+3,i,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,p+4,t,t,t,e,t,e,t,e,t,t,t,e,e,t,t,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,t,t,e,e,t,t,e,e,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,e,e,e,p+5,r,r,p+6,p+7],dt=[[c,c,c,c,c,c,c,c,c,W,S,W,m,S,c,c,c,c,c,c,c,c,c,c,c,c,c,c,S,S,S,W,m,t,t,T,T,T,t,t,t,t,t,_,R,_,R,R,h,h,h,h,h,h,h,h,h,h,R,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,c,c,c,c,c,c,S,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,R,t,T,T,T,T,t,t,t,t,e,t,t,c,t,t,T,T,h,h,t,e,t,t,t,h,e,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,e,e,e,e,e,e,e,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,e,t,t,t,t,t,t,t,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,i,n,i,n,n,i,n,n,i,n,t,t,t,t,t,t,t,t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t,t,t,t,t,i,i,i,i,i,t,t,t,t,t,t,t,t,t,t,t],[g,g,g,g,t,t,t,t,r,T,T,r,R,r,t,t,n,n,n,n,n,n,n,n,n,n,n,r,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,g,g,g,g,g,g,g,g,g,g,T,g,g,r,r,r,n,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,g,t,n,n,n,n,n,n,r,r,n,n,t,n,n,n,n,r,r,h,h,h,h,h,h,h,h,h,h,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,r,r,n,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,n,n,n,n,n,n,n,n,n,n,n,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,n,n,n,n,n,n,n,n,n,i,i,t,t,t,t,i,t,t,t,t,t],[m,m,m,m,m,m,m,m,m,m,m,c,c,c,e,i,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,m,S,ft,lt,ct,ht,Tt,R,T,T,T,T,T,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,R,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,m,c,c,c,c,c,t,t,t,t,t,c,c,c,c,c,c,h,e,t,t,h,h,h,h,h,h,_,_,t,t,t,e,h,h,h,h,h,h,h,h,h,h,_,_,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,t,e,e,e,e,e,t,t,t,t,t,i,n,i,i,i,i,i,i,i,i,i,i,_,i,i,i,i,i,i,i,i,i,i,i,i,i,t,i,i,i,i,i,t,i,t,i,i,t,i,i,t,i,i,i,i,i,i,i,i,i,i,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,n,n,n,n,n,n,n,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,R,t,R,t,t,R,t,t,t,t,t,t,t,t,t,T,t,t,_,_,t,t,t,t,t,T,T,t,t,t,t,t,r,r,r,r,r,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,t,c],[t,t,t,T,T,T,t,t,t,t,t,_,R,_,R,R,h,h,h,h,h,h,h,h,h,h,R,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,t,t,t,t,t,t,t,t,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,t,t,t,e,e,e,e,e,e,t,t,e,e,e,e,e,e,t,t,e,e,e,e,e,e,t,t,e,e,e,t,t,t,T,T,t,t,t,T,T,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t]];class kt{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(o,s,u){if(this.sourceToTarget=[],this.targetToSource=[],!o)return"";if(Ot(this.sourceToTarget,this.targetToSource,o.length),!this.checkParameters(s,u))return o;s=this.inputFormat,u=this.outputFormat;let f=o;const l=It,L=H(s.charAt(1)),A=H(u.charAt(1)),d=(s.startsWith("I")?"L":s.charAt(0))+L,U=(u.startsWith("I")?"L":u.charAt(0))+A,B=s.charAt(2)+u.charAt(2);l.defInFormat=d,l.defOutFormat=U,l.defSwap=B;const w=V(o,d,U,B,l);let N=!1;return u.charAt(1)==="R"?N=!0:u.charAt(1)!=="C"&&u.charAt(1)!=="D"||(N=this.checkContextual(w)==="rtl"),this.sourceToTarget=F,this.targetToSource=xt(this.sourceToTarget),k=this.targetToSource,f=s.charAt(3)===u.charAt(3)?w:u.charAt(3)==="S"?gt(N,w):Rt(w,N,!0),this.sourceToTarget=F,this.targetToSource=k,this.levels=P,f}_inputFormatSetter(o){if(!J.test(o))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=o}_outputFormatSetter(o){if(!J.test(o))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=o}checkParameters(o,s){return o?this._inputFormatSetter(o):o=this.inputFormat,s?this._outputFormatSetter(s):s=this.outputFormat,o!==s}checkContextual(o){let s=D(o);if(s!=="ltr"&&s!=="rtl"){try{s=document.dir.toLowerCase()}catch{}s!=="ltr"&&s!=="rtl"&&(s="ltr")}return s}hasBidiChar(o){return Dt.test(o)}}function V(a,o,s,u,f){const l=Ut(a,{inFormat:o,outFormat:s,swap:u},f);if(l.inFormat===l.outFormat)return a;o=l.inFormat,s=l.outFormat,u=l.swap;const L=o.slice(0,1),A=o.slice(1,4),d=s.slice(0,1),U=s.slice(1,4);if(f.inFormat=o,f.outFormat=s,f.swap=u,L==="L"&&s==="VLTR"){if(A==="LTR")return f.dir=v,b(a,f);if(A==="RTL")return f.dir=O,b(a,f)}if(L==="V"&&d==="V")return f.dir=A==="RTL"?O:v,M(a,f);if(L==="L"&&s==="VRTL")return A==="LTR"?(f.dir=v,a=b(a,f)):(f.dir=O,a=b(a,f)),M(a);if(o==="VLTR"&&s==="LLTR")return f.dir=v,b(a,f);if(L==="V"&&d==="L"&&A!==U)return a=M(a),A==="RTL"?V(a,"LLTR","VLTR",u,f):V(a,"LRTL","VRTL",u,f);if(o==="VRTL"&&s==="LRTL")return V(a,"LRTL","VRTL",u,f);if(L==="L"&&d==="L"){const B=f.swap;return f.swap=B.slice(0,1)+"N",A==="RTL"?(f.dir=O,a=b(a,f),f.swap="N"+B.slice(1,3),f.dir=v,a=b(a,f)):(f.dir=v,a=b(a,f),f.swap="N"+B.slice(1,3),a=V(a,"VLTR","LRTL",f.swap,f)),a}return a}function Ut(a,o,s){if(o.inFormat===void 0&&(o.inFormat=s.defInFormat),o.outFormat===void 0&&(o.outFormat=s.defOutFormat),o.swap===void 0&&(o.swap=s.defSwap),o.inFormat===o.outFormat)return o;const u=o.inFormat.slice(0,1),f=o.outFormat.slice(0,1);let l,L=o.inFormat.slice(1,4),A=o.outFormat.slice(1,4);return L.startsWith("C")&&(l=D(a),L=l==="ltr"||l==="rtl"?l.toUpperCase():o.inFormat.charAt(2)==="L"?"LTR":"RTL",o.inFormat=u+L),A.startsWith("C")&&(l=D(a),l==="rtl"?A="RTL":l==="ltr"?(l=mt(a),A=l.toUpperCase()):A=o.outFormat.charAt(2)==="L"?"LTR":"RTL",o.outFormat=f+A),o}function gt(a,o,s){if(o.length===0)return"";a===void 0&&(a=!0);const u=(o=String(o)).split("");let f=0,l=1,L=u.length;a||(f=u.length-1,l=-1,L=1);const A=Bt(u,f,l,L);let d="";for(let U=0;U<u.length;U++)St(A,A.length,U)>-1?(X(k,U,!a,-1),F.splice(U,1)):d+=u[U];return d}function Bt(a,o,s,u,f){let l=0;const L=[];let A=0;for(let d=o;d*s<u;d+=s)if(Q(a[d])||x(a[d])){if(a[d]==="ل"&&bt(a,d+s,s,u)){a[d]=Vt(a[d+s],l===0?$:tt),d+=s,Et(a,d,s,u),L[A]=d,A++,l=0;continue}const U=a[d];l===1?a[d]=Z(a,d+s,s,u)?vt(a[d]):Y(a[d],et):Z(a,d+s,s,u)===!0?a[d]=Y(a[d],ot):a[d]=Y(a[d],rt),x(U)||(l=1),Ct(U)===!0&&(l=0)}else l=0;return L}function D(a){const o=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(a);return o?o[0]<="z"?"ltr":"rtl":""}function mt(a){const o=a.split("");return o.reverse(),D(o.join(""))}function Rt(a,o,s){if(a.length===0)return"";o===void 0&&(o=!0);let u="";const f=(a=String(a)).split("");for(let l=0;l<a.length;l++){let L=!1;if(f[l]>="ﹰ"&&f[l]<"\uFEFF"){const A=a.charCodeAt(l);f[l]>="ﻵ"&&f[l]<="ﻼ"?(o?(l>0&&s&&f[l-1]===" "?u=u.slice(0,-1)+"ل":(u+="ل",L=!0),u+=E[(A-65269)/2]):(u+=E[(A-65269)/2],u+="ل",l+1<a.length&&s&&f[l+1]===" "?l++:L=!0),L&&(X(k,l,!0,1),F.splice(l,0,F[l]))):u+=at[A-65136]}else u+=f[l]}return u}function b(a,o){const s=a.split(""),u=[];return K(s,u,o),_t(s,u,o),G(2,s,u,o),G(1,s,u,o),P=u,s.join("")}function K(a,o,s){const u=a.length,f=s.dir?ut:st;let l=0,L=-1;const A=[],d=[];s.hiLevel=s.dir,s.lastArabic=!1,s.hasUbatAl=!1,s.hasUbatB=!1,s.hasUbatS=!1;for(let U=0;U<u;U++)A[U]=pt(a[U]);for(let U=0;U<u;U++){const B=l,w=wt(a,A,d,U,s);d[U]=w,l=f[B][w];const N=240&l;l&=15;const y=f[l][Wt];if(o[U]=y,N>0)if(N===16){for(let C=L;C<U;C++)o[C]=1;L=-1}else L=-1;if(f[l][jt])L===-1&&(L=U);else if(L>-1){for(let C=L;C<U;C++)o[C]=y;L=-1}A[U]===S&&(o[U]=0),s.hiLevel|=y}s.hasUbatS&&Ft(A,o,u,s)}function Ft(a,o,s,u){for(let f=0;f<s;f++)if(a[f]===W){o[f]=u.dir;for(let l=f-1;l>=0&&a[l]===m;l--)o[l]=u.dir}}function _t(a,o,s){if(s.hiLevel!==0&&s.swap[0]!==s.swap[1])for(let u=0;u<a.length;u++)o[u]===1&&(a[u]=Nt(a[u]))}function pt(a){const o=a.charCodeAt(0),s=Lt[o>>8];return s<p?s:dt[s-p][255&o]}function M(a,o){const s=a.split("");if(o){const u=[];K(s,u,o),P=u}return s.reverse(),F.reverse(),s.join("")}function St(a,o,s){for(let u=0;u<o;u++)if(a[u]===s)return u;return-1}function Q(a){for(let o=0;o<q.length;o++)if(a>=q[o]&&a<=it[o])return!0;return!1}function Z(a,o,s,u){for(;o*s<u&&x(a[o]);)o+=s;return!!(o*s<u&&Q(a[o]))}function bt(a,o,s,u){for(;o*s<u&&x(a[o]);)o+=s;let f=" ";if(!(o*s<u))return!1;f=a[o];for(let l=0;l<E.length;l++)if(E[l]===f)return!0;return!1}function G(a,o,s,u){if(u.hiLevel<a)return;if(a===1&&u.dir===O&&!u.hasUbatB)return o.reverse(),void F.reverse();const f=o.length;let l,L,A,d,U,B=0;for(;B<f;){if(s[B]>=a){for(l=B+1;l<f&&s[l]>=a;)l++;for(L=B,A=l-1;L<A;L++,A--)d=o[L],o[L]=o[A],o[A]=d,U=F[L],F[L]=F[A],F[A]=U;B=l}B++}}function wt(a,o,s,u,f){const l=o[u];return{UBAT_L:()=>(f.lastArabic=!1,e),UBAT_R:()=>(f.lastArabic=!1,i),UBAT_ON:()=>t,UBAT_AN:()=>g,UBAT_EN:()=>f.lastArabic?g:h,UBAT_AL:()=>(f.lastArabic=!0,f.hasUbatAl=!0,i),UBAT_WS:()=>t,UBAT_CS:()=>{let L,A;return u<1||u+1>=o.length||(L=s[u-1])!==h&&L!==g||(A=o[u+1])!==h&&A!==g?t:(f.lastArabic&&(A=g),A===L?A:t)},UBAT_ES:()=>(u>0?s[u-1]:S)===h&&u+1<o.length&&o[u+1]===h?h:t,UBAT_ET:()=>{if(u>0&&s[u-1]===h)return h;if(f.lastArabic)return t;let L=u+1;const A=o.length;for(;L<A&&o[L]===T;)L++;return L<A&&o[L]===h?h:t},UBAT_NSM:()=>{if(f.inFormat==="VLTR"){const L=o.length;let A=u+1;for(;A<L&&o[A]===n;)A++;if(A<L){const d=a[u].charCodeAt(0),U=d>=1425&&d<=2303||d===64286,B=o[A];if(U&&(B===i||B===r))return i}}return u<1||o[u-1]===S?t:s[u-1]},UBAT_B:()=>(f.lastArabic=!0,f.hasUbatB=!0,f.dir),UBAT_S:()=>(f.hasUbatS=!0,t),UBAT_LRE:()=>(f.lastArabic=!1,t),UBAT_RLE:()=>(f.lastArabic=!1,t),UBAT_LRO:()=>(f.lastArabic=!1,t),UBAT_RLO:()=>(f.lastArabic=!1,t),UBAT_PDF:()=>(f.lastArabic=!1,t),UBAT_BN:()=>t}[At[l]]()}function Nt(a){let o,s=0,u=I.length-1;for(;s<=u;)if(o=Math.floor((s+u)/2),a<I[o][0])u=o-1;else{if(!(a>I[o][0]))return I[o][1];s=o+1}return a}function Ct(a){for(let o=0;o<z.length;o++)if(z[o]===a)return!0;return!1}function vt(a){for(let o=0;o<j.length;o++)if(a===j[o])return nt[o];return a}function Y(a,o){for(let s=0;s<j.length;s++)if(a===j[s])return o[s];return a}function x(a){return a>="ً"&&a<="ٕ"}function H(a){return a==="L"?"LTR":a==="R"?"RTL":a==="C"?"CLR":a==="D"?"CRL":""}function Et(a,o,s,u){for(;o*s<u&&x(a[o]);)o+=s;return o*s<u&&(a[o]=" ",!0)}function Vt(a,o){for(let s=0;s<E.length;s++)if(a===E[s])return o[s];return a}function Ot(a,o,s){F=[],P=[];for(let u=0;u<s;u++)a[u]=u,o[u]=u,F[u]=u}function xt(a){const o=new Array(a.length);for(let s=0;s<a.length;s++)o[a[s]]=s;return o}function X(a,o,s,u){for(let f=0;f<a.length;f++)(a[f]>o||!s&&a[f]===o)&&(a[f]+=u)}let F=[],k=[],P=[];const It={dir:0,defInFormat:"LLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,defOutFormat:""},Wt=5,jt=6,v=0,O=1,J=/^[(I|V)][(L|RCD)][(Y|N)][(S|N)]N$/,Dt=/[\u0591-\u06ff\ufb1d-\ufefc]/;export{kt as C};
